---
import type { StarlightRouteData } from "@astrojs/starlight/route-data";
import { NormalizePathPosix } from "../utils/NormalizePath"
import clsx from "clsx";

type SideBarLink = Extract<StarlightRouteData['sidebar'][number], { type: "link"}>

export interface Props extends SideBarLink {
    depth: number
}

const { href, label, depth } = Astro.props 



const pathname = NormalizePathPosix(Astro.locals.starlightRoute.id);
const applyLinkClasses = (href: string) => clsx(depth > 0 && [
        "block w-full pl-3.5 before:pointer-events-none",
        "before:absolute before:top-1/2 before:-left-1",
        "before:h-1.5 before:w-1.5 before:-translate-y-1/2",
        "before:rounded-full",
        depth > 1 && "ml-6"
    ],
    NormalizePathPosix(href) === pathname
    ? [ "font-semibold text-sky-500 before:bg-sky-500" ]
    : [
        "text-slate-500 before:hidden",
        "before:bg-slate-300 hover:text-slate-600",
        "hover:before:block dark:text-slate-400",
        "dark:before:bg-slate-700 dark:hover:text-slate-300"
    ])
---


<a  href={NormalizePathPosix(href)} class:list={[
    applyLinkClasses(href)]} >
    {label}
</a>
