---
title: GiriÅŸ
---

## BaÅŸlamadan Ã–nce

{% aside type="note" %}
    TakÄ±ldÄ±ÄŸÄ±nÄ±z noktada, yardÄ±m almak iÃ§in GitHub Ã¼zerinden issue aÃ§abllirsiniz.
{% /aside %}

## Ergosfare Nedir?

Ergosfare, CQRS (Command Query Responsibility Segregation) ve mesajlaÅŸma desenlerini yÃ¼ksek performans ve modÃ¼ler mimari ile uygulamak iÃ§in tasarlanmÄ±ÅŸ modern, hafif ve reflection kullanmayan bir .NET Mediation kÃ¼tÃ¼phanesidir.


### Temel Ã–zellikler

* **Reflection yok & AOT dostu**  
  KayÄ±t iÅŸlemleri derleme sÄ±rasÄ±nda yapÄ±lÄ±r, Ã§alÄ±ÅŸma zamanÄ± reflectionâ€™dan kaÃ§Ä±nÄ±lÄ±r. Bu ÅŸekilde, uygulama soÄŸuk baÅŸlatma sÃ¼resini ve performansÄ± iyileÅŸtirir ve AOT (Ahead-Of-Time) derlenmiÅŸ .NET uygulamalarÄ±yla uyumlu Ã§alÄ±ÅŸÄ±r.

* **Tamamen aÃ§Ä±k kaynak (MIT lisansÄ±)**  
  MIT lisansÄ± altÄ±nda Ã¼cretsiz kullanÄ±labilir, deÄŸiÅŸtirilebilir ve daÄŸÄ±tÄ±labilir; maksimum esneklik ve ÅŸeffaflÄ±k saÄŸlar.

* **ModÃ¼ler mimari**  
  Komutlar, Sorgular, Olaylar ve AkÄ±ÅŸlar gibi bileÅŸenler baÄŸÄ±msÄ±z olarak kullanÄ±labilir. YalnÄ±zca ihtiyacÄ±nÄ±z olanÄ± ekleyerek uygulamanÄ±n ayak izini minimumda tutabilirsiniz.

* **Kovaryans ve kontravaryans desteÄŸi**  
  KarmaÅŸÄ±k tip hiyerarÅŸilerinde esnek, polimorfik handler eÅŸleÅŸtirmeleri yapÄ±labilir.

* **Pipeline Ã¶nleyici (interceptor)'larÄ±**  
  Logging, validation ve hata yÃ¶netimi gibi katmanlar arasÄ± (cross-cutting) konular iÃ§in Pre, Post ve Exception aÅŸamalarÄ±nda esnek yakalama (interception) desteÄŸi saÄŸlar.

* **DI dostu**  
  Microsoft.Extensions.DependencyInjection ile tam uyumlu; ek dÄ±ÅŸ baÄŸÄ±mlÄ±lÄ±k zorunluluÄŸu yoktur.

---

## Neden Ergosfare?

GeliÅŸtiriciler sÄ±kÃ§a sorar:  
**â€œMediatR gibi diÄŸer mediator kÃ¼tÃ¼phanelerine kÄ±yasla neden Ergosfare kullanmalÄ±yÄ±m?â€**

Ergosfare, modern .NET uygulamalarÄ± iÃ§in **yÃ¼ksek performanslÄ±, reflection kullanmayan aracÄ±lÄ±k (mediation) Ã§Ã¶zÃ¼mÃ¼** saÄŸlar â€” hem **baÅŸlangÄ±Ã§ hem de Ã§alÄ±ÅŸma zamanÄ± davranÄ±ÅŸlarÄ±nÄ± Ã¶ngÃ¶rÃ¼lebilir ve verimli** tutar.

---

### Ergosfareâ€™yi SeÃ§mek Ä°Ã§in Temel Sebepler

#### Reflection Olmadan Performans

* Ã‡oÄŸu mediator kÃ¼tÃ¼phanesinin aksine, **Ergosfare Ã§alÄ±ÅŸma zamanÄ±nda reflection kullanmaz**.  
* TÃ¼m dispatch iÅŸlemleri (komutlar, sorgular, olaylar) **tamamen derlenmiÅŸ** olduÄŸu iÃ§in **hÄ±zlÄ± ve Ã¶ngÃ¶rÃ¼lebilir bir Ã§alÄ±ÅŸma zamanÄ± saÄŸlar**.

#### Descriptor BazlÄ± Esnek KayÄ±t

Ergosfare, handler ve interceptorâ€™lar iÃ§in **birleÅŸik kayÄ±t APIâ€™leri** sunar. KayÄ±t sÄ±rasÄ±nda, Ã§alÄ±ÅŸma zamanÄ± iÃ§in gerekli tÃ¼m metadataâ€™yÄ± iÃ§eren **descriptor**â€™lar oluÅŸturur.

#### KayÄ±t SeÃ§enekleri

1. **Tip Ã¼zerinden kayÄ±t**

```cs
services.AddErgosfare(options => {
    options.AddCommandModule(builder => builder.Register(typeof(LoggingInterceptor)));
})
````

2. **Generic tip Ã¼zerinden kayÄ±t**

```cs
services.AddErgosfare(options => {
    options.AddCommandModule(builder => builder.Register<LoggingInterceptor>());
})
```

3. **Assembly Ã¼zerinden kayÄ±t (sadece startup zamanÄ± taramasÄ±)**

```cs
services.AddErgosfare(options => {
    options.AddCommandModule(builder => builder.RegisterFromAssembly(Assembly.GetExecutingAssembly()));
})
```

#### Descriptor Ä°Ã§ YapÄ±sÄ±

Her descriptor aÅŸaÄŸÄ±daki bilgileri tutar:

| Alan                     | AmaÃ§                                     |
| ------------------------ | ---------------------------------------- |
| Command/Query tipi       | Handler/interceptor hangi tipleri iÅŸler  |
| Result tipi              | Handlerâ€™Ä±n Ã§Ä±ktÄ±sÄ±                       |
| Interceptor rolÃ¼         | Pre / Post / Exception                   |
| Handler instance bilgisi | Instance ile kayÄ±t yapÄ±lÄ±yorsa opsiyonel |

**SonuÃ§:** Ã‡alÄ±ÅŸma zamanÄ± dispatch iÅŸlemleri **reflection yok**, AOT uyumlu ve yÃ¼ksek performanslÄ±dÄ±r.

---

### AOT Dostu

* Ã‡alÄ±ÅŸma zamanÄ± tamamen derlenmiÅŸ, reflection gerektirmez.
* **NativeAOT, Blazor WebAssembly ve minimal APIâ€™ler** ile Ã§alÄ±ÅŸÄ±r.

### ModÃ¼ler Mimari

* Komutlar, Sorgular, Olaylar ve AkÄ±ÅŸlar baÄŸÄ±msÄ±z modÃ¼llerdir.
* YalnÄ±zca ihtiyacÄ±nÄ±z olanÄ± ekleyin â€” baÄŸÄ±mlÄ±lÄ±klarÄ± azaltÄ±r ve projeyi yÃ¶netilebilir tutar.

### Interceptor Pipeline (Pre/Post/Exception)

* Logging, validation veya retry gibi katmanlar arasÄ± konular temiz bir ÅŸekilde eklenebilir.

```csharp
public class LoggingInterceptor : ICommandPreInterceptor<TCommand>
{
    public Task HandleAsync(TCommand command, IExecutionContext context)
    {
        Console.WriteLine($"{typeof(TCommand).Name} iÅŸleniyor");
        return Task.CompletedTask;
    }
}
```

* KayÄ±t birleÅŸiktir:

```cs
services.AddErgosfare(
    cfg => cfg
        // command handler
        .Register<CreateOrderHandler>();    
        // Pre-interceptor                         
        .Register<LoggingInterceptor<CreateOrderCommand>>();   
        // Post-interceptor
        .Register<LoggingPostInterceptor<CreateOrderCommand, bool>>();
        // or just for all 
        .RegisterFromAssembly(Assembly.GetExecutingAssembly());
)
```

âœ… Temiz, minimal ve tutarlÄ± â€” MediatRâ€™Ä±n pipeline davranÄ±ÅŸlarÄ±ndan farklÄ± olarak.

---

### Esnek Tip KullanÄ±mÄ±

* Kovaryans ve kontravaryans sayesinde handlerâ€™lar **base veya tÃ¼retilmiÅŸ tipleri** sorunsuz ÅŸekilde kullanabilir.
* Polimorfik komutlar/olaylar iÃ§in idealdir.

### GeliÅŸtirici Dostu API

* `Microsoft.Extensions.DependencyInjection` ile bÃ¼tÃ¼nleÅŸir.
* Minimal boilerplate, gÃ¼Ã§lÃ¼ tipli API ve aÃ§Ä±k kayÄ±t.

### Hafif ve BaÄŸÄ±msÄ±z

* Minimal ayak izi, gereksiz runtime baÄŸÄ±mlÄ±lÄ±ÄŸÄ± yok.
* Modern, yÃ¼ksek performanslÄ± .NET uygulamalarÄ± iÃ§in optimize edilmiÅŸtir.

### AÃ§Ä±k Kaynak ve Åeffaf

* MIT lisanslÄ±, tamamen aÃ§Ä±k kaynak.
* Aktif geliÅŸtirme, performans ve sadelik odaklÄ±.

---

## MediatR vs Ergosfare (Yan Yana KarÅŸÄ±laÅŸtÄ±rma)

| Ã–zellik / Konu          | **Ergosfare**                                                          | **MediatR**                                        |
| ----------------------- | ---------------------------------------------------------------------- | -------------------------------------------------- |
| Reflection kullanÄ±mÄ±    | âœ… Sadece startup zamanÄ± assembly taramasÄ±                              | âŒ Pipelineâ€™lar iÃ§in runtime reflection             |
| Runtime dispatch        | âœ… Tamamen derlenmiÅŸ (descriptor tabanlÄ±)                               | âŒ Reflection aÄŸÄ±rlÄ±klÄ±                             |
| AOT uyumluluÄŸu          | âœ… Tam destek (NativeAOT, Blazor WASM)                                  | âŒ SÄ±nÄ±rlÄ±                                          |
| Interceptor / Pipeline  | âœ… Pre/Post/Exception interceptor                                       | âš ï¸ `IPipelineBehavior<TRequest,TResponse>` gerekli |
| KayÄ±t API               | âœ… BirleÅŸik (`Register<T>()`, `Register(Type)`, `RegisterFromAssembly`) | âŒ FarklÄ± APIâ€™ler, pipeline ayrÄ±                    |
| Kovaryans/Contravaryans | âœ… Destekleniyor                                                        | âŒ Yerel olarak yok                                 |
| Startup performansÄ±     | âš¡ HÄ±zlÄ± (assembly taramasÄ± sadece bir kez)                             | ğŸŒ BÃ¼yÃ¼k uygulamalarda yavaÅŸ                       |
| ModÃ¼lerlik              | âœ… Komutlar/Sorgular/Olaylar/AkÄ±ÅŸlar                                    | âŒ Monolitik                                        |
| Ayak izi                | ğŸª¶ Hafif                                                               | ğŸ“¦ AÄŸÄ±r                                            |
| Boilerplate             | Minimal                                                                | Daha fazla                                         |
| Okunabilirlik           | Temiz, ayrÄ± sorumluluklar                                              | Pipeline mantÄ±ÄŸÄ±yla sarÄ±lmÄ±ÅŸ                       |

---

### Kod Ã–rneÄŸi: `CreateOrder` Komutu

#### MediatR Versiyonu

```cs
public record CreateOrderCommand(int OrderId, string Product) : IRequest<bool>;

public class CreateOrderHandler : IRequestHandler<CreateOrderCommand, bool>
{
    public async Task<bool> Handle(CreateOrderCommand request, CancellationToken cancellationToken)
    {
        Console.WriteLine($"MediatR: {request.OrderId} sipariÅŸi oluÅŸturuluyor");
        await Task.Delay(10);
        return true;
    }
}
```

* Logging/validation iÃ§in `IPipelineBehavior` gerekir.
* Assembly taramasÄ± iÃ§in reflection aÄŸÄ±rlÄ±klÄ±.

---

#### Ergosfare Versiyonu

> Dikkat: Komut modÃ¼lÃ¼ iÃ§in Ã¶zel `ICommand` arayÃ¼zÃ¼ kullanÄ±yoruz, tek `IRequest` yerine.

```cs
public record CreateOrderCommand(int OrderId, string Product) : ICommand<bool>;

public class CreateOrderHandler : ICommandHandler<CreateOrderCommand, bool>
{
    public Task<bool> Handle(CreateOrderCommand command, IExecutionContext context)
    {
        Console.WriteLine($"Ergosfare: {command.OrderId} sipariÅŸi oluÅŸturuluyor");
        return ValueTask.FromResult(true);
    }
}
```

```cs
// Pre-Interceptor
public class LoggingInterceptor<TCommand> : ICommandPreInterceptor<TCommand>
    where TCommand : ICommand
{
    public Task HandleAsync(TCommand command, IExecutionContext context)
    {
        Console.WriteLine($"{typeof(TCommand).Name} iÅŸleniyor");
        return ValueTask.CompletedTask;
    }
}
```

```cs
builder.Services.AddErgosfare(o => {
    // TÃ¼m handler ve interceptorâ€™larÄ± kaydeder
    o.AddCommandModule(b => b.RegisterFromAssembly(typeof(CreateOrderHandler).Assembly))
});
```

* Handler ve interceptor iÃ§in birleÅŸik `Register` API.
* Descriptor tabanlÄ±, reflection kullanmayan runtime dispatch.
* Minimal boilerplate, net ayrÄ±lmÄ±ÅŸ sorumluluklar.

---

## Ne Zaman Ergosfare KullanmalÄ±?

* Modern .NET uygulamalarÄ± iÃ§in **hÄ±zlÄ±, AOT-ready mediator** gerekiyorsa.
* **Temiz, modÃ¼ler ve reflection kullanmayan runtime** isteniyorsa.
* **CQRS, event-driven veya streaming pipeline** inÅŸa ediyorsanÄ±z.
* **Minimal boilerplate ve birleÅŸik kayÄ±t** tercih ediyorsanÄ±z.
* Logging, validation ve metrikler iÃ§in **built-in, temiz interceptor** istiyorsanÄ±z.

---

âœ… **Ã–zet:**

> **Ergosfare modern .NET mediatorâ€™Ä±dÄ±r â€” hÄ±zlÄ±, modÃ¼ler, reflection kullanmayan ve yÃ¼ksek performanslÄ±, AOT-dostu uygulamalar iÃ§in hazÄ±r.**

